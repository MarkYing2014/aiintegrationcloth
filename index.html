<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>蓝博科技</title>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      
      // Set default consent state
      gtag('consent', 'default', {
        analytics_storage: 'denied',
        ad_storage: 'denied',
        ad_user_data: 'denied',
        ad_personalization: 'denied',
        functionality_storage: 'denied',
        security_storage: 'denied'
      });
      
      // Check for existing consent
      if (localStorage.getItem('cookieConsent')) {
        const consent = JSON.parse(localStorage.getItem('cookieConsent'));
        gtag('consent', 'update', {
          analytics_storage: consent.analytics ? 'granted' : 'denied',
          ad_storage: consent.marketing ? 'granted' : 'denied',
          ad_user_data: consent.marketing ? 'granted' : 'denied',
          ad_personalization: consent.marketing ? 'granted' : 'denied',
          functionality_storage: consent.necessary ? 'granted' : 'denied',
          security_storage: consent.necessary ? 'granted' : 'denied'
        });
      }
      
      gtag('config', 'GA_MEASUREMENT_ID');
    </script>

    <!-- Cookie Banner Styles -->
    <style>
      .cookie-banner {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(0, 0, 0, 0.9);
        color: white;
        padding: 20px;
        z-index: 10000;
        display: none;
      }
      .cookie-banner.show {
        display: block;
      }
      .cookie-content {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 20px;
      }
      .cookie-text {
        flex: 1;
      }
      .cookie-buttons {
        display: flex;
        gap: 10px;
      }
      .cookie-btn {
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-weight: bold;
      }
      .cookie-btn.accept {
        background: #4CAF50;
        color: white;
      }
      .cookie-btn.decline {
        background: #f44336;
        color: white;
      }
      .cookie-btn.customize {
        background: #2196F3;
        color: white;
      }
      @media (max-width: 768px) {
        .cookie-content {
          flex-direction: column;
          text-align: center;
        }
        .cookie-buttons {
          justify-content: center;
        }
      }
    </style>
    
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>

    <!-- Cookie Banner HTML -->
    <div id="cookie-banner" class="cookie-banner">
      <div class="cookie-content">
        <div class="cookie-text">
          <strong>我们使用 Cookie</strong><br>
          本网站使用 Cookie 以增强您的体验并分析我们的流量。 
          点击 "接受所有"，您将同意我们使用 Cookie。
        </div>
        <div class="cookie-buttons">
          <button class="cookie-btn decline" onclick="handleCookieChoice(false)">拒绝</button>
          <button class="cookie-btn customize" onclick="showCookieSettings()">自定义</button>
          <button class="cookie-btn accept" onclick="handleCookieChoice(true)">接受所有</button>
        </div>
      </div>
    </div>

    <!-- Cookie Banner Script -->
    <script>
      // Show cookie banner if no consent given
      function showCookieBanner() {
        if (!localStorage.getItem('cookieConsent')) {
          document.getElementById('cookie-banner').classList.add('show');
        }
      }

      // Handle cookie choice
      function handleCookieChoice(acceptAll) {
        const consent = {
          necessary: true, // Always required
          analytics: acceptAll,
          marketing: acceptAll,
          timestamp: new Date().toISOString()
        };
        
        localStorage.setItem('cookieConsent', JSON.stringify(consent));
        
        // Update gtag consent
        if (typeof gtag !== 'undefined') {
          gtag('consent', 'update', {
            analytics_storage: consent.analytics ? 'granted' : 'denied',
            ad_storage: consent.marketing ? 'granted' : 'denied',
            ad_user_data: consent.marketing ? 'granted' : 'denied',
            ad_personalization: consent.marketing ? 'granted' : 'denied',
            functionality_storage: consent.necessary ? 'granted' : 'denied',
            security_storage: consent.necessary ? 'granted' : 'denied'
          });
        }
        
        hideCookieBanner();
      }

      // Hide cookie banner
      function hideCookieBanner() {
        document.getElementById('cookie-banner').classList.remove('show');
      }

      // Show cookie settings (placeholder)
      function showCookieSettings() {
        alert('Cookie settings would open here. You can customize this to show detailed options.');
      }

      // Show banner on page load
      document.addEventListener('DOMContentLoaded', showCookieBanner);
    </script>
  </body>
</html>
